#+STARTUP: indent
* Raspbian setup notes
** setup avahi
*** install
apt install avahi-daemon
*** add waln0 in conf
sudo emacs /etc/avahi/avahi-daemon.conf

[server]
host-name=rasbpi
#domain-name=local
#browse-domains=0pointer.de, zeroconf.org
use-ipv4=yes
use-ipv6=no
allow-interfaces=eth0,wlan0
***** Note:
1.add *wlan0* to allow-interfaces
2.host-name is *raspbi*

*** add /etc/avahi/services/multiple.service
<?xml version="1.0" standalone='no'?>
<!DOCTYPE service-group SYSTEM "avahi-service.dtd">
<service-group>
        <name replace-wildcards="yes">%h</name>
        <service>
                <type>_device-info._tcp</type>
                <port>0</port>
		<txt-record>model=RackMac</txt-record>
	</service>
	<service>
                <type>_ssh._tcp</type>
		<port>22</port>
	</service>
	<service>
                <type>_http._tcp</type>
		<port>80</port>
	</service>
</service-group>

*** verification
On another PC, use command 'avahi-discover -a',
the 'raspbi' host should appear

** Setup eth0/wlan0 route
we want eth0 <--> RFID Reader, which is LAN 192.168.88.0
and want wlan0 <--> wireless AP which is LAN 192.168.68.0
and is connected to the Internet, current route is:

Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         192.168.68.1    0.0.0.0         UG    303    0        0 wlan0
0.0.0.0         192.168.88.1    0.0.0.0         UG    202    0        0 eth0
192.168.68.0    0.0.0.0         255.255.255.0   U     303    0        0 wlan0
192.168.88.0    0.0.0.0         255.255.255.0   U     202    0        0 eth0

*** install package
sudo apt install ifmetric

*** set eth0 with lower priority
sudo ifmetric eth0 305

*** setup permanently
add to /etc/dhcpcd.conf:

static domain_name_servers=8.8.8.8
static routers=192.168.88.1
static ip_address=192.168.88.1
metric 305

*** verify
route -n

Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         192.168.68.1    0.0.0.0         UG    303    0        0 wlan0
0.0.0.0         192.168.88.1    0.0.0.0         UG    305    0        0 eth0
192.168.68.0    0.0.0.0         255.255.255.0   U     303    0        0 wlan0
192.168.88.0    0.0.0.0         255.255.255.0   U     305    0        0 eth0

Route wlan0 as higher priority (lower value) can solve the blocking situation
on internet access
