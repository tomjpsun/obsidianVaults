#開發環境
# build IGB driver with Emacs LSP support:
```bash
cd <Intel IGB driver source>
CC=clang LLVM=1 bear -- make
```
# build LinuxPTP with Emacs LSP support:
```bash
cd <LinuxPTP source>
CC=clang LLVM=1 bear -- make
```

# microdeb:
	192.168.193.90
	ssh: 192.168.193.1 -p 9022
	 emacs :  `C-x` `C-f` `/ssh:tom@192.168.1.193#9022:/home/tom/work/ethernet-linux-igb/src`


# DHCP list


![[Pasted image 20241107171036.png]]
# nmcli 指令範例

## show

```bash
$ nmcli con show
NAME                UUID                                  TYPE      DEVICE
Wired connection 2  60dece34-a3da-3e06-ad10-9ff34f495087  ethernet  eth1
lo                  2fd164b3-c657-4287-b6b6-bd4de15f6e39  loopback  lo
Shader              3b9ea857-db27-461f-84a8-d0d45ffef661  wifi      wlan0
Wired connection 1  556d2b8f-7143-35ad-874c-469f7c649424  ethernet  --
```

## Link up { by conn name }
```bash
$ sudo nmcli connection up Wired\ connection\ 2
```
## Link up { by device }
```
sudo nmcli device
```

```
DEVICE     TYPE      STATE                   CONNECTION
eth1           ethernet  connected               Wired connection 2
lo             loopback  connected (externally)  lo
wlan0          wifi      connected               Shader
p2p-dev-wlan0  wifi-p2p  disconnected            --
eth0           ethernet  unavailable             --
```

```
sudo nmcli device connect eth1
```

# Emacs LSP support on RaspBPi

### 安裝 clangd ARM 版本
```bash
sudo apt install clangd lld
```
### init.el 加上
```bash
(setq lsp-clients-clangd-executable "/usr/bin/clangd")
```

### generate compile_commands.json

```bash
cd <Davicom driver source>
# 更正, 進入 kernel 的 make 系統, 不會使用 clang, 所以 CC=clang 是無效的.
# 用 bear 產生 compile_commands.json 就可以, compiler 不一定要是 clang
# CC=clang LLVM=1 bear -- make
bear -- make
```

## lsp 抱怨沒有 AST

從 `*clangd::stderr*` 裏面看到是因爲下面錯誤:
`clangd:Couldn‘t build compiler instance`
這是因爲 clang 不支援 API 'lp64'
導致後續 lsp 抱怨沒有 AST, 然後無法工作

解決辦法, 在 source 目錄下,新增一個檔案 : `.clangd` 內容是:

```bash
CompileFlags:
  Remove: -mabi=lp64
```

這樣 emacs lsp-mode 就可以順利啓動了
# Github Repo Analyzer Key

LangChain tool: https://github.com/jitinchekka/github-repo-analyzer

> [!NOTE]
> > 心得: 一個很快就消耗 OpenAI quota 的東西, 不好用

```
GITHUB_TOKEN="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"
OPENAI_API_KEY="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"
ACTIVELOOP_TOKEN="eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJpZCI6InN3ZWV0aG9tZTAyMTIyMyIsImFwaV9rZXkiOiJzVk5TZE5fUjE5NnhWVk9sLTNQeHhrOEd2cDhxcURFbnNxVVBEdHRZcXlTWkoifQ."
```

> [!NOTE] Token Key 的關聯帳號
>GitHub: tomjpsun
>OpenAI: sweethome021223
>ActiveLoop: sweethome021223



# 如何移除 driver ?

```
sudo nmcli device down eth1
sudo rmmod dm9051
```

# 如何安裝 driver ?

```
sudo make install
sudo nmcli device up eth1
```



> [!NOTE] 沒有依照操作, 容易出現下面現象:
> [  185.153053] dm9051 spi0.1 eth1: Link is Up - 100Mbps/Full - flow control rx/tx
[  191.464947] dm9051_irq_flag(db) 8
[  191.464976] Set Reg, IRQF_TRIGGER_LOW 8, IRQF_TRIGGER_HIGH 4
[  194.713079] dm9051_irq_flag(db) 8
[  194.713107] Set Reg, IRQF_TRIGGER_LOW 8, IRQF_TRIGGER_HIGH 4
[  214.297602] dm9051_irq_flag(db) 8
[  214.297617] Set Reg, IRQF_TRIGGER_LOW 8, IRQF_TRIGGER_HIGH 4
[  221.465857] dm9051_irq_flag(db) 8
[  221.465883] Set Reg, IRQF_TRIGGER_LOW 8, IRQF_TRIGGER_HIGH 4
[  251.470378] dm9051_irq_flag(db) 8
[  251.470410] Set Reg, IRQF_TRIGGER_LOW 8, IRQF_TRIGGER_HIGH 4
[  281.462749] dm9051_irq_flag(db) 8
[  281.462780] Set Reg, IRQF_TRIGGER_LOW 8, IRQF_TRIGGER_HIGH 4
[  311.471052] dm9051_irq_flag(db) 8
[  311.471081] Set Reg, IRQF_TRIGGER_LOW 8, IRQF_TRIGGER_HIGH 4
[  319.731133] dm9051_irq_flag(db) 8
[  319.731162] Set Reg, IRQF_TRIGGER_LOW 8, IRQF_TRIGGER_HIGH 4


\#
